# Оптимизация обработки стали
### Описание проекта
Исследование проводилось на основе данных от металлургического комбината. Цель исследования — сократить потребление электроэнергии на этапе обработки стали за счет предсказания температуры стали.
### Описание проекта
Для лучшего понимания данных, необходимо описать технологический процесс легирования стали.

Сталь обрабатывают в металлическом ковше, облицованным изнутри огнеупорным кирпичом, вместимостью около 100 тонн. В ковш заливают расплавленную сталь и подогревают до нужной температуры графитовыми электродами, установленными в крышке ковша. Затем из сплава выводится сера (десульфурация), и за счет добавления примесей корректируется его химический состав . Для проверки состава отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат.

Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки. Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов.
### Данные
Данные были предоставлены разбиты на несколько наборов:
- `data_arc.csv` — данные об работе электродов;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В некоторых наборах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.
### Предобработка данных
После удаления аномальных и редких значений, мы объединили все данные в один датасет, агрегировав записи по номеру партии, а затем были рассчитаны дополнительные признаки для обучения моделей:
- cредние активные, реактивыне и полные мощности по партии;
- общее время нагрева партии;
- температура на первом замере (до начала легирования);
- общее количество добавленных сыпучих и проволочных материалов;
- количество итераций нагрева партии.
На выходе мы получили данные по 2298 партиям и 32 признака для модели, один из которых являлся целевым.

<a href="https://imgbb.com/"><img src="https://i.ibb.co/5GbXch3/corr-matrix.png" alt="corr-matrix" border="0"></a>

### Обучение моделей
Лучший результат показала модель CatBoostRegressor с learning_rate равным 0.1 и глубиной дерева 2 — ее MAE при проверке кросс-валидацией 5.54. Именно ее работу мы протестировали на тестовой выборке.

На тесте модель показа МАЕ 5.87 — эта метрика на 2.6 градуса превосходит работу константной модели (ее МАЕ 8.47) и должна позволить металлургическому комбинату сэкономить электроэнергию.
Ниже приведен график реальных показателей температуры и прогнозов модели:

<a href="https://ibb.co/gVSP9HV"><img src="https://i.ibb.co/WtkP5qt/image.png" alt="image" border="0"></a>
